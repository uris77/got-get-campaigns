(function(c){c.module("url_utils",[]).factory("urlUtils",["$window","$location",function(a,d){return{redirectHome:function(){a.location.href="http://"+d.host()+":"+d.port()}}}])})(angular);utils={isNumber:function(c){var a=parseInt(c.trim());return!_.isUndefined(c)&&!_.isEmpty(c.trim())&&(0<a||0>a)&&_.isNumber(a)}};
(function(c){var a={create:"/api/surveys",list:"/api/surveys",getById:function(a){return"/api/surveys/"+a}};c.module("surveys.list",[]).config(["$stateProvider",function(a){a.state("surveys",{url:"surveys",templateUrl:"/surveys/index.html"}).state("surveys.list",{url:"/list",templateUrl:"/surveys/list.html",controller:"SurveysListController"}).state("surveys.show",{url:"/:id",templateUrl:"/surveys/show.html",controller:"SurveyShowController"})}]).factory("SurveyRepositoryService",["$http",function(d){return{list:function(){return d.get(a.list)},
fetch:function(b){return d.get(a.getById(b))}}}]).controller("SurveysListController",["$scope","urlUtils","SurveyRepositoryService",function(a,b,c){c.list().success(function(b){a.surveys=b}).error(function(a,d,c){401==d&&b.redirectHome();console.error("ERROR: ",a)})}]).controller("SurveyShowController",["$scope","$stateParams","urlUtils","SurveyRepositoryService",function(a,b,c,e){e.fetch(b.id).success(function(b){a.survey=b.survey;a.locations=b.locations}).error(function(a,d,b){console.error("ERROR: ",
a);401==d&&c.redirectHome()})}])})(angular);
(function(c){var a={apiUrls:{create:"/api/surveys",list:"/api/surveys",getById:function(a){return"/api/surveys/"+a}},isYear:function(a){return utils.isNumber(a)&&2010<parseInt(a)&&2030>parseInt(a)},validateSurveyForm:function(d,b){var c=[];a.isYear(b)||c.push("Year: Provide a valid year! (E.g. 2014)");_.isUndefined(d)&&c.push("Month: Select a month.");return c}};c.module("surveys.create",[]).config(["$stateProvider",function(a){a.state("surveysCreate",{url:"/surveys/create",templateUrl:"/surveys/create.html",
controller:"SurveysCreateController"})}]).factory("CreateSurveyService",["$http",function(d){return{create:function(b){return d.post(a.apiUrls.create,b)}}}]).controller("SurveysCreateController",["$scope","$state","urlUtils","CreateSurveyService",function(d,b,c,e){d.months=[{name:"January"},{name:"February"},{name:"March"},{name:"April"},{name:"May"},{name:"June"},{name:"July"},{name:"August"},{name:"September"},{name:"October"},{name:"November"},{name:"December"}];d.submit=function(){var f=a.validateSurveyForm(d.month,
d.year);0<f.length?d.errors=f:e.create({month:d.month.name,year:d.year}).success(function(){b.transitionTo("surveys.list")}).error(function(a,b){d.errors=a.errors;401==b&&c.redirectHome()})}}])})(angular);(function(c){angular.module("surveys",["surveys.list","surveys.create"])})(angular);
(function(c){function a(a){var b=[];(_.isUndefined(a.name)||_.isEmpty(a.name.trim()))&&b.push("Name: provide a name for the location.");_.isUndefined(a.district)&&b.push("District: select a district.");_.isUndefined(a.locationType)&&b.push("Type of location: select what type of outlet this location is.");_.isUndefined(a.loc)?(b.push("Latitude: specify the latitude."),b.push("Longitude: specify the longitude.")):(!_.isUndefined(a.loc.lon)&&utils.isNumber(a.loc.lon)||b.push("Longitude: specify a valid longitude"),
!_.isUndefined(a.loc.lat)&&utils.isNumber(a.loc.lat)||b.push("Latitude: specify a valid latitude."));return b}c.module("location.create",[]).factory("LocationCreateService",["$http",function(a){return{create:function(b){return a.post("/api/locations",b)}}}]).controller("LocationCreateController",["$scope","$state","urlUtils","LocationCreateService",function(d,b,c,e){d.districts=[{name:"Corozal"},{name:"Orange Walk"},{name:"Belize"},{name:"Cayo"},{name:"Stann Creek"},{name:"Toledo"}];d.locationTypes=
[{name:"Traditional"},{name:"Non-Traditional"},{name:"Hotspot"}];d.submit=function(){var f={name:d.name,district:d.district?d.district.name:void 0,locationType:d.locationType?d.locationType.name:void 0,loc:{lon:d.longitude,lat:d.latitude}},h=a(f);0<h.length?d.errors=h:e.create(f).success(function(){b.transitionTo("locations.list")}).error(function(a,b){d.errors=a.errors;401==b&&c.redirectHome()})}}])})(angular);
(function(c){c.module("locations.list",[]).factory("LocationListService",["$http",function(a){return{list:function(){return a.get("/api/locations")},search:function(d){return a.get("/api/locations/search?locationName\x3d"+d)}}}]).controller("LocationListController",["$scope","urlUtils","LocationListService",function(a,d,b){b.list().success(function(b){a.locations=b}).error(function(a,b){console.error("ERROR: ",a);401==b&&d.redirectHome()});a.search=function(c){b.search(c).success(function(b){a.locations=
b}).error(function(a,b){console.error("Error executing search: ",a);401==b&&d.redirectHome()})}}])})(angular);
(function(c){c.module("locations.details",[]).factory("LocationSurveysGateway",["$http",function(a){return{fetchDetails:function(d){return a.get("/api/locations/"+d)}}}]).controller("LocationDetailsController",["$scope, $stateParams","urlUtils","LocationSurveysGateway",function(a,d,b,c){a.summary=!0;a.locationId=d.locationId;c.fetchDetails(a.locationId).success(function(b){a.surveys=b.surveys;a.location=b.location}).error(function(a,d){401==d?b.redirectHome():(alert("An error occurred fetching the data from the server!"),
console.error("ERROR fetching data: ",a))});a.showMore=function(b){a.summary=!1;a.survey=b};a.showLess=function(){a.summary=!0}}])})(angular);
(function(c){c.module("PasmoLocation",["location.create","locations.list","locations.details"]).config(["$stateProvider",function(a){a.state("locations",{url:"locations",templateUrl:"/locations/index.html"}).state("locations.list",{url:"/list",templateUrl:"/locations/list.html",controller:"LocationListController"}).state("locations.create",{url:"/create",templateUrl:"/locations/create.html",controller:"LocationCreateController"}).state("locations.summary",{url:"/:locationId/summary",templateUrl:"/locations/surveys_summary.html",
controller:"LocationDetailsController"})}])})(angular);
(function(c){c.module("NonTraditionalOutletSurvey.gatewayService",[]).factory("NonTraditionalSurveyGatewayService",["$http",function(a){return{fetchOutlets:function(){return a.get("/api/locations/byType/non_traditional")},fetchSurveys:function(d){return a.get("/api/surveys/"+d+"/non_traditional_outlets")},createSurvey:function(d,b){return a.post("/api/surveys/"+d+"/non_traditional_outlets",b)},fetchSurvey:function(d,b){return a.get("/api/surveys/"+d+"/non_traditional_outlets/"+b)},editSurvey:function(d,
b,c){return a.put("/api/surveys/"+d+"/non_traditional_outlets/"+b,c)}}}])})(angular);(function(c){c.module("NonTraditionalOutletSurvey.list",[]).controller("NonTraditionalOutletSurveyListController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",function(a,d,b,c,e){a.surveyId=b.id;e.fetchSurveys(b.id).success(function(b){a.surveys=b}).error(function(a,b){console.error("Error retrieving surveys: ",a);401==b&&c.redirectHome()})}])})(angular);
(function(c){c.module("NonTraditionalOutletSurvey.create",[]).controller("NonTraditionalOutletSurveyCreateController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",function(a,d,b,c,e){a.outlet_types=[{name:"Restaurant"},{name:"Pharmacy"}];e.fetchOutlets().success(function(b){a.locations=b;0==a.locations.length&&(a.noLocatons=!0)}).error(function(a,b){console.error("Error retreiving outlets: ",a);401==b&&c.redirectHome()});a.cancel=function(){d.transitionTo("listNonTraditionalOutlets",
{id:b.id})};a.submit=function(){a.errors=[];a.location||(a.errors=["Please chose a location!"]);a.outlet_type||a.errors.push("Please select an outlet type!");if(0==a.errors.length){var f={outreach:a.outreach,outletType:a.outlet_type,targetPopulations:a.target_populations,condomsAvailable:_.isBoolean(a.condoms_available)?a.condoms_available:!1,lubesAvailable:_.isBoolean(a.lube_available)?a.lube_available:!1,gigi:_.isBoolean(a.gigi)?a.gigi:!1,location:{id:a.location.id,name:a.location.name,district:a.location.district,
loc:a.location.loc}};e.createSurvey(b.id,f).success(function(a){d.transitionTo("listNonTraditionalOutlets",{id:b.id})}).error(function(a,b){401==b?c.redirectHome():(console.error("ERROR: ",a),alert("An error occurred!"))})}}}])})(angular);
(function(c){c.module("NonTraditionalOutletSurvey.edit",[]).controller("NonTraditionalOutletSurveyEditController",["$scope","$state","$stateParams","urlUtils","NonTraditionalSurveyGatewayService",function(a,d,b,c,e){a.survey_id=b.survey_id;a.outlet_survey_id=b.outlet_survey_id;e.fetchSurvey(a.survey_id,a.outlet_survey_id).success(function(b){a.survey=b;a.survey.outletType=JSON.parse(b.outletType).name}).error(function(a){console.error("Error fetching survey data: ",a);401==status&&c.redirectHome()});
a.cancel=function(){d.transitionTo("listNonTraditionalOutlets",{id:a.survey_id})};a.submit=function(){var b={outreach:a.survey.outreach,targetPopulations:a.survey.targetPopulations,condomsAvailable:_.isBoolean(a.survey.condomsAvailable)?a.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(a.survey.lubesAvailable)?a.survey.lubesAvailable:!1,gigi:_.isBoolean(a.survey.gigi)?a.survey.gigi:!1};e.editSurvey(a.survey_id,a.outlet_survey_id,b).success(function(b){a.cancel()}).error(function(a,b){401==b?
c.redirectHome():(console.error("ERROR: ",a),alert("An error occurred!"))})}}])})(angular);
(function(){angular.module("NonTraditionalOutletSurvey",["NonTraditionalOutletSurvey.gatewayService","NonTraditionalOutletSurvey.list","NonTraditionalOutletSurvey.create","NonTraditionalOutletSurvey.edit"]).config(["$stateProvider",function(c){c.state("listNonTraditionalOutlets",{url:"/surveys/:id/non_traditional_outlet/list",templateUrl:"/surveys/non_traditional_outlets/list.html",controller:"NonTraditionalOutletSurveyListController"}).state("createNonTraditionalOutlets",{url:"/surveys/:id/non_traditional_outlet/create",
templateUrl:"/surveys/non_traditional_outlets/create_form.html",controller:"NonTraditionalOutletSurveyCreateController"}).state("editNonTraditionalOutlets",{url:"/surveys/:survey_id/non_traditional_outlet/:outlet_survey_id/edit",templateUrl:"/surveys/non_traditional_outlets/edit.html",controller:"NonTraditionalOutletSurveyEditController"})}])})(angular);
(function(c){c.module("Hotspots.gateway",[]).factory("GatewayService",["$http",function(a){return{fetchOutlets:function(){return a.get("/api/locations/byType/hotspot")},fetchSurveys:function(d){return a.get("/api/surveys/"+d+"/hotspots")},createSurvey:function(d,b){return a.post("/api/surveys/"+d+"/hotspots",b)},fetchHotspotSurvey:function(d,b){return a.get("/api/surveys/"+d+"/hotspots/"+b)},editHotspotSurvey:function(d,b,c){return a.put("/api/surveys/"+d+"/hotspots/"+b,c)}}}])})(angular);
(function(c){c.module("Hotspots.list",[]).controller("ListController",["$scope","$state","$stateParams","urlUtils","GatewayService",function(a,d,b,c,e){a.surveyId=b.id;e.fetchSurveys(b.id).success(function(b){a.surveys=b}).error(function(a,b){console.error("Error retrieving surveys: ",a);401==b&&c.redirectHome()})}])})(angular);
(function(c){c.module("Hotspots.create",[]).controller("CreateController",["$scope","$state","$stateParams","urlUtils","GatewayService",function(a,d,b,c,e){e.fetchOutlets().success(function(b){a.locations=b;0==a.locations.length&&(a.noLocatons=!0)}).error(function(a,b){console.error("Error retreiving outlets: ",a);401==b&&c.redirectHome()});a.cancel=function(){d.transitionTo("hotspotsList",{id:b.id})};a.submit=function(){a.errors=[];a.location||(a.errors=["Please chose a location!"]);if(0==a.errors.length){var f=
{outreach:a.outreach,targetPopulations:a.target_populations,condomsAvailable:_.isBoolean(a.condoms_available)?a.condoms_available:!1,lubesAvailable:_.isBoolean(a.lube_available)?a.lube_available:!1,gigi:_.isBoolean(a.gigi)?a.gigi:!1,location:{id:a.location.id,name:a.location.name,district:a.location.district,loc:a.location.loc}};e.createSurvey(b.id,f).success(function(a){d.transitionTo("hotspotsList",{id:b.id})}).error(function(a,b){401==b?c.redirectHome():(console.error("ERROR: ",a),alert("An error occurred!"))})}}}])})(angular);
(function(c){c.module("Hotspots.edit",[]).controller("HotspotSurveyEditController",["$scope","$state","$stateParams","urlUtils","GatewayService",function(a,d,b,c,e){a.surveyId=b.survey_id;a.hotspotSurveyId=b.hotspot_survey_id;e.fetchHotspotSurvey(a.surveyId,a.hotspotSurveyId).success(function(b){a.survey=b}).error(function(a,b){console.error("Error fetching hotspot survey: ",a);401==b&&c.redirectHome()});a.cancel=function(){d.transitionTo("hotspotsList",{id:a.surveyId})};a.submit=function(){var b=
{outreach:a.survey.outreach,targetPopulations:a.survey.targetPopulations,condomsAvailable:_.isBoolean(a.survey.condomsAvailable)?a.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(a.survey.lubesAvailable)?a.survey.lubesAvailable:!1,gigi:_.isBoolean(a.survey.gigi)?a.survey.gigi:!1};e.editHotspotSurvey(a.surveyId,a.hotspotSurveyId,b).success(function(b){a.cancel()}).error(function(a,b){401==b?c.redirectHome():(console.error("ERROR: ",a),alert("An error occurred!"))})}}])})(angular);
(function(c){c.module("Hotspots",[]).config(["$stateProvider",function(a){a.state("hotspotsList",{url:"/surveys/:id/hotspots/list",templateUrl:"/surveys/hotspots/list.html",controller:"ListController"}).state("hotspotsCreate",{url:"/surveys/:id/hotspots/create",templateUrl:"/surveys/hotspots/create_form.html",controller:"CreateController"}).state("hotspotsEdit",{url:"/surveys/:survey_id/hotspots/:hotspot_survey_id/edit",templateUrl:"/surveys/hotspots/edit.html",controller:"HotspotSurveyEditController"})}])})(angular);
(function(c){c.module("TraditionalOutletSurvey.gatewayService",[]).factory("TraditionalOutletGatewayService",["$http",function(a){return{fetchTraditionalOutlets:function(){return a.get("/api/locations/byType/traditional")},createTraditonalOutlet:function(d,b){return a.post("/api/surveys/"+b+"/traditional_outlets",d)},fetchTraditionalOutletsSurvey:function(d){return a.get("/api/surveys/"+d+"/traditional_outlets")},fetchSurvey:function(d,b){return a.get("/api/surveys/"+d+"/traditional_outlets/"+b)},
updateSurvey:function(d,b,c){return a.put("/api/surveys/"+b+"/traditional_outlets/"+c,d)}}}])})(angular);(function(c){c.module("TraditionalOutletSurvey.list",[]).controller("TraditionalOutletSurveyListController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",function(a,d,b,c,e){a.id=b.id;e.fetchTraditionalOutletsSurvey(b.id).success(function(b){a.surveys=b}).error(function(a,b){console.error("ERROR: ",a);401==b&&c.redirectHome()})}])})(angular);
(function(c){c.module("TraditionalOutletSurvey.create",[]).controller("TraditionalOutletSurveyCreateController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",function(a,c,b,g,e){e.fetchTraditionalOutlets().success(function(b){console.log("Got traditional outlets: ",b);a.locations=b;0==b.length&&(a.noLocations=!0,console.log("No Locations: ",a.noLocations))}).error(function(a,b){console.error("ERROR: ",a);401==b&&g.redirectHome()});a.submit=function(){var f={condomsAvailable:_.isBoolean(a.condoms_available)?
a.condoms_available:!1,lubesAvailable:_.isBoolean(a.lube_available)?a.lube_available:!1,gigi:_.isBoolean(a.gigi)?a.gigi:!1,location:{id:a.location.id,name:a.location.name,district:a.location.district,loc:a.location.loc}};e.createTraditonalOutlet(f,b.id).success(function(a){c.transitionTo("surveys.listTraditionalOutlets",{id:b.id})}).error(function(a,b){401==b?g.redirectHome():console.error("ERROR: ",a)})};a.cancel=function(){c.transitionTo("surveys.listTraditionalOutlets",{id:b.id})}}])})(angular);
(function(c){c.module("TraditionalOutletSurvey.edit",[]).controller("TraditionalOutletSurveyEditController",["$scope","$state","$stateParams","urlUtils","TraditionalOutletGatewayService",function(a,c,b,g,e){a.surveyId=b.survey_id;e.fetchSurvey(b.survey_id,b.traditional_outlet_survey_id).success(function(b){a.survey=b}).error(function(a,b){401==b?g.redirectHome():(alert("Could not retrieve survey from server!"),console.log("Error retrieving traditonal outlet from server: ",a))});a.submit=function(){var f=
{condomsAvailable:_.isBoolean(a.survey.condomsAvailable)?a.survey.condomsAvailable:!1,lubesAvailable:_.isBoolean(a.survey.lubesAvailable)?a.survey.lubesAvailable:!1,gigi:_.isBoolean(a.survey.gigi)?a.survey.gigi:!1};e.updateSurvey(f,b.survey_id,b.traditional_outlet_survey_id).success(function(a){c.transitionTo("surveys.listTraditionalOutlets",{id:b.survey_id})}).error(function(a,b){console.error("ERROR: ",a);401==b&&g.redirectHome()})};a.cancel=function(){c.transitionTo("surveys.listTraditionalOutlets",
{id:b.survey_id})}}])})(angular);
(function(c){c.module("TraditionaOutletSurvey",["TraditionalOutletSurvey.gatewayService","TraditionalOutletSurvey.list","TraditionalOutletSurvey.create","TraditionalOutletSurvey.edit"]).config(["$stateProvider",function(a){a.state("surveys.traditionalOutlet",{url:"/:id/traditional_outlet/create",templateUrl:"/surveys/traditional_outlets/create_form.html",controller:"TraditionalOutletSurveyCreateController"}).state("surveys.listTraditionalOutlets",{url:"/:id/traditional_outlet/list",templateUrl:"/surveys/traditional_outlets/list.html",
controller:"TraditionalOutletSurveyListController"}).state("surveys.editTraditionalOutlet",{url:"/surveys/:survey_id/traditional_outlet/:traditional_outlet_survey_id",templateUrl:"/surveys/traditional_outlets/edit.html",controller:"TraditionalOutletSurveyEditController"})}])})(angular);var PasmoApp={apiUrls:{}};
angular.module("PasmoApp","ui.router url_utils surveys PasmoLocation TraditionaOutletSurvey NonTraditionalOutletSurvey Hotspots".split(" ")).run(["$rootScope","$http","$state",function(c,a,d){console.info("Starting Pasmo App......")}]);